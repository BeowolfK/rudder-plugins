{
  "id":"ansible_policies",
  "version":"1.0",
  "category":"Ansible_Policies_plugin",
  "description":"This technique install and deploy an Ansible Playbook on a target node and execute it. Its result will be reported in details in a Rudder report.",
  "name":"ansible report",
  "calls":[
    {
      "method":"package_present",
      "condition":"any",
      "disableReporting":false,
      "component":"Package present",
      "parameters":[
        {
          "name":"name",
          "value":"ansible"
        },
        {
          "name":"version",
          "value":""
        },
        {
          "name":"architecture",
          "value":""
        },
        {
          "name":"provider",
          "value":""
        }
      ],
      "id":"ac883087-f009-4dfc-916a-2f043c253109"
    },
    {
      "method":"file_from_shared_folder",
      "condition":"any",
      "disableReporting":false,
      "component":"File copy from Rudder shared folder",
      "parameters":[
        {
          "name":"source",
          "value":"${PathPlaybookServer}"
        },
        {
          "name":"path",
          "value":"${PathPlaybookAgent}"
        },
        {
          "name":"hash_type",
          "value":"sha256"
        }
      ],
      "id":"b94f0c10-05f8-4b42-9342-e62d27e28c19"
    },
    {
      "method":"command_execution_result",
      "condition":"any",
      "disableReporting":false,
      "component":"Command execution result",
      "parameters":[
        {
          "name":"command",
          "value":"/var/rudder/packages/rudder-plugin-ansible-policies/ansible.sh \"${PathPlaybookAgent}\" \"${this.promiser_pid}\" \"${report_data.canonified_directive_id}\""
        },
        {
          "name":"kept_codes",
          "value":"0"
        },
        {
          "name":"repaired_codes",
          "value":"2"
        }
      ],
      "id":"5d8a7e17-b14d-4d61-ade0-e0d645e21c43"
    },
    {
      "method":"file_report_content",
      "condition":"any",
      "disableReporting":false,
      "component":"File report content",
      "parameters":[
        {
          "name":"path",
          "value":"/var/rudder/tmp/ansible_policies_${this.promiser_pid}_${report_data.canonified_directive_id}"
        },
        {
          "name":"regex",
          "value":""
        },
        {
          "name":"context",
          "value":""
        }
      ],
      "id":"8e1d5d11-b18d-41bc-bc52-6b402cb01615"
    },
    {
      "method":"file_absent",
      "condition":"any",
      "disableReporting":false,
      "component":"File absent",
      "parameters":[
        {
          "name":"path",
          "value":"/var/rudder/tmp/ansible_policies_${this.promiser_pid}_${report_data.canonified_directive_id}"
        }
      ],
      "id":"9fd2225c-5ee8-4142-a5d2-d25387125c1a"
    }
  ],
  "parameter":[
    {
      "id":"dd26d25f-4315-41e6-9387-8df289710de4",
      "name":"PathPlaybookServer",
      "description":"",
      "mayBeEmpty":false
    },
    {
      "id":"0ca6b218-2dd1-44e6-a216-88e7bdf2a5ef",
      "name":"PathPlaybookAgent",
      "description":"",
      "mayBeEmpty":false
    }
  ],
  "resources":[],
  "source":"editor"
}
